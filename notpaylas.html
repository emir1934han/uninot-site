<!DOCTYPE html>
<html lang="tr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Not PaylaÅŸ | UniNot</title>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <link rel="stylesheet" href="Anasayfa.css">
    <link rel="stylesheet" href="NotPaylas.css">
</head>

<body>

    <nav class="navbar">
        <div class="container nav-container">
            <div class="logo">
                <i class="fa-solid fa-graduation-cap"></i> UniNot
            </div>
            <ul class="nav-links">
                <li><a href="index.html">Anasayfa</a></li>
                <li><a href="not-al.html">Not SatÄ±n Al</a></li>
                <li><a href="kredilerim.html">Kredilerim</a></li>
                <li><a href="kayit.html" class="btn-register" id="authBtn">KayÄ±t Ol</a></li>
            </ul>
            <div class="hamburger">
                <i class="fa-solid fa-bars"></i>
            </div>
        </div>
    </nav>

    <section class="upload-section">
        <div class="container">

            <div class="upload-header">
                <h1>Ders Notunu PaylaÅŸ</h1>
                <p>NotlarÄ±nÄ± yÃ¼kle, fiyatÄ±nÄ± belirle ve kazanmaya baÅŸla.</p>
            </div>

            <div class="upload-container">
                <form id="uploadForm" class="upload-form">

                    <div class="file-drop-area">
                        <span class="fake-btn">Dosya SeÃ§</span>
                        <span class="file-msg">veya sÃ¼rÃ¼kleyip buraya bÄ±rak (Sadece PDF)</span>
                        
                        <input class="file-input" id="fileInput" type="file" accept="application/pdf" required>
                        
                        <div class="icon-bg"><i class="fa-solid fa-cloud-arrow-up"></i></div>
                    </div>

                    <div class="form-grid">

                        <div class="form-group">
                            <label><i class="fa-solid fa-book"></i> Ders AdÄ±</label>
                            <input type="text" id="lessonName" placeholder="Ã–rn: Matematik 1 - Vize NotlarÄ±" required>
                        </div>

                        <div class="form-group">
                            <label><i class="fa-solid fa-layer-group"></i> BÃ¶lÃ¼m / Program</label>
                            <div class="search-dropdown">
                                <input type="text" id="categoryInput" placeholder="BÃ¶lÃ¼m ara (Ã–rn: YÃ¶netim BiliÅŸim...)"
                                    autocomplete="off">
                                <div id="categoryList" class="dropdown-list"></div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label><i class="fa-solid fa-building-columns"></i> Ãœniversite</label>
                            <div class="search-dropdown">
                                <input type="text" id="universityInput"
                                    placeholder="Ãœniversite ara (Ã–rn: Mehmet Akif...)" autocomplete="off">
                                <div id="universityList" class="dropdown-list"></div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label><i class="fa-solid fa-tag"></i> Fiyat (â‚º)</label>
                            <input type="number" id="price" placeholder="Ã–rn: 50" required min="0">
                        </div>
                    </div>

                    <div class="form-group full-width">
                        <label><i class="fa-solid fa-pen"></i> Not HakkÄ±nda AÃ§Ä±klama</label>
                        <textarea id="description" rows="4"
                            placeholder="Notun iÃ§eriÄŸi hakkÄ±nda bilgi ver... (Hangi konular var, kaÃ§ sayfa vb.)"
                            required></textarea>
                    </div>

                    <div class="form-action">
                        <button type="submit" class="btn-submit">
                            <i class="fa-solid fa-paper-plane"></i> YayÄ±na Al
                        </button>
                    </div>

                </form>
            </div>

        </div>
    </section>

    <footer>
        <div class="container footer-content">
            <div class="footer-brand">
                <h2>UniNot</h2>
                <p>Ã–ÄŸrencilerin dijital kÃ¼tÃ¼phanesi ve gelir kapÄ±sÄ±.</p>
                <div class="social-links">
                    <a href="#"><i class="fa-brands fa-instagram"></i></a>
                    <a href="#"><i class="fa-brands fa-twitter"></i></a>
                </div>
            </div>
            <div class="footer-menu">
                <h3>Platform</h3>
                <ul>
                    <li><a href="#">NasÄ±l Ã‡alÄ±ÅŸÄ±r?</a></li>
                    <li><a href="not-al.html">Not Ara</a></li>
                    <li><a href="#">FiyatlandÄ±rma</a></li>
                </ul>
            </div>
            <div class="footer-menu">
                <h3>Kurumsal</h3>
                <ul>
                    <li><a href="#">HakkÄ±mÄ±zda</a></li>
                    <li><a href="#">Ä°letiÅŸim</a></li>
                    <li><a href="#">Gizlilik PolitikasÄ±</a></li>
                </ul>
            </div>
        </div>
        <div class="copyright">
            <p>&copy; 2025 UniNot. TÃ¼m haklarÄ± saklÄ±dÄ±r.</p>
        </div>
    </footer>

    <script type="module">
        import { supabase } from './supabase.js';

        // --- DEVASA LÄ°STELER (HEPSÄ° GERÄ° GELDÄ°) ---
        const universities = [
            "Abant Ä°zzet Baysal Ãœniversitesi", "Abdullah GÃ¼l Ãœniversitesi", "AcÄ±badem Mehmet Ali AydÄ±nlar Ãœniversitesi", 
            "Adana Alparslan TÃ¼rkeÅŸ Bilim ve Teknoloji Ãœniversitesi", "AdÄ±yaman Ãœniversitesi", "Afyon Kocatepe Ãœniversitesi", 
            "Afyonkarahisar SaÄŸlÄ±k Bilimleri Ãœniversitesi", "AÄŸrÄ± Ä°brahim Ã‡eÃ§en Ãœniversitesi", "Akdeniz Ãœniversitesi", 
            "Aksaray Ãœniversitesi", "Alanya Alaaddin Keykubat Ãœniversitesi", "Alanya Hamdullah Emin PaÅŸa Ãœniversitesi", 
            "AltÄ±nbaÅŸ Ãœniversitesi", "Amasya Ãœniversitesi", "Anadolu Ãœniversitesi", "Ankara Bilim Ãœniversitesi", 
            "Ankara HacÄ± Bayram Veli Ãœniversitesi", "Ankara Medipol Ãœniversitesi", "Ankara MÃ¼zik ve GÃ¼zel Sanatlar Ãœniversitesi", 
            "Ankara Sosyal Bilimler Ãœniversitesi", "Ankara Ãœniversitesi", "Ankara YÄ±ldÄ±rÄ±m BeyazÄ±t Ãœniversitesi", 
            "Antalya Akev Ãœniversitesi", "Antalya Bilim Ãœniversitesi", "Ardahan Ãœniversitesi", "Artvin Ã‡oruh Ãœniversitesi", 
            "AtaÅŸehir AdÄ±gÃ¼zel Meslek YÃ¼ksekokulu", "AtatÃ¼rk Ãœniversitesi", "AtÄ±lÄ±m Ãœniversitesi", "Avrasya Ãœniversitesi", 
            "AydÄ±n Adnan Menderes Ãœniversitesi", "BahÃ§eÅŸehir Ãœniversitesi", "BalÄ±kesir Ãœniversitesi", 
            "BandÄ±rma Onyedi EylÃ¼l Ãœniversitesi", "BartÄ±n Ãœniversitesi", "BaÅŸkent Ãœniversitesi", "Batman Ãœniversitesi", 
            "Bayburt Ãœniversitesi", "Beykent Ãœniversitesi", "Beykoz Ãœniversitesi", "BezmiÃ¢lem VakÄ±f Ãœniversitesi", 
            "Bilecik Åžeyh Edebali Ãœniversitesi", "BingÃ¶l Ãœniversitesi", "Biruni Ãœniversitesi", "Bitlis Eren Ãœniversitesi", 
            "BoÄŸaziÃ§i Ãœniversitesi", "Bolu Abant Ä°zzet Baysal Ãœniversitesi", "Burdur Mehmet Akif Ersoy Ãœniversitesi", 
            "Bursa Teknik Ãœniversitesi", "Bursa UludaÄŸ Ãœniversitesi", "Ã‡aÄŸ Ãœniversitesi", "Ã‡anakkale Onsekiz Mart Ãœniversitesi", 
            "Ã‡ankaya Ãœniversitesi", "Ã‡ankÄ±rÄ± Karatekin Ãœniversitesi", "Ã‡ukurova Ãœniversitesi", "Dicle Ãœniversitesi", 
            "DoÄŸuÅŸ Ãœniversitesi", "Dokuz EylÃ¼l Ãœniversitesi", "DÃ¼zce Ãœniversitesi", "Ege Ãœniversitesi", "Erciyes Ãœniversitesi", 
            "Erzincan Binali YÄ±ldÄ±rÄ±m Ãœniversitesi", "Erzurum Teknik Ãœniversitesi", "EskiÅŸehir Osmangazi Ãœniversitesi", 
            "EskiÅŸehir Teknik Ãœniversitesi", "Fatih Sultan Mehmet VakÄ±f Ãœniversitesi", "FenerbahÃ§e Ãœniversitesi", 
            "FÄ±rat Ãœniversitesi", "Galatasaray Ãœniversitesi", "Gazi Ãœniversitesi", "Gaziantep Ä°slam Bilim ve Teknoloji Ãœniversitesi", 
            "Gaziantep Ãœniversitesi", "Gebze Teknik Ãœniversitesi", "Giresun Ãœniversitesi", "GÃ¼mÃ¼ÅŸhane Ãœniversitesi", 
            "Hacettepe Ãœniversitesi", "Hakkari Ãœniversitesi", "HaliÃ§ Ãœniversitesi", "Harran Ãœniversitesi", 
            "Hasan Kalyoncu Ãœniversitesi", "Hatay Mustafa Kemal Ãœniversitesi", "Hitit Ãœniversitesi", "IÄŸdÄ±r Ãœniversitesi", 
            "Isparta UygulamalÄ± Bilimler Ãœniversitesi", "IÅŸÄ±k Ãœniversitesi", "Ä°bn Haldun Ãœniversitesi", 
            "Ä°hsan DoÄŸramacÄ± Bilkent Ãœniversitesi", "Ä°nÃ¶nÃ¼ Ãœniversitesi", "Ä°skenderun Teknik Ãœniversitesi", 
            "Ä°stanbul Arel Ãœniversitesi", "Ä°stanbul Atlas Ãœniversitesi", "Ä°stanbul AydÄ±n Ãœniversitesi", 
            "Ä°stanbul Ayvansaray Ãœniversitesi", "Ä°stanbul Bilgi Ãœniversitesi", "Ä°stanbul Galata Ãœniversitesi", 
            "Ä°stanbul GeliÅŸim Ãœniversitesi", "Ä°stanbul Kent Ãœniversitesi", "Ä°stanbul KÃ¼ltÃ¼r Ãœniversitesi", 
            "Ä°stanbul Medeniyet Ãœniversitesi", "Ä°stanbul Medipol Ãœniversitesi", "Ä°stanbul Okan Ãœniversitesi", 
            "Ä°stanbul Rumeli Ãœniversitesi", "Ä°stanbul Sabahattin Zaim Ãœniversitesi", "Ä°stanbul SaÄŸlÄ±k ve Teknoloji Ãœniversitesi", 
            "Ä°stanbul Teknik Ãœniversitesi", "Ä°stanbul Ticaret Ãœniversitesi", "Ä°stanbul TopkapÄ± Ãœniversitesi", 
            "Ä°stanbul Ãœniversitesi", "Ä°stanbul Ãœniversitesi-CerrahpaÅŸa", "Ä°stanbul Yeni YÃ¼zyÄ±l Ãœniversitesi", 
            "Ä°stanbul 29 MayÄ±s Ãœniversitesi", "Ä°stinye Ãœniversitesi", "Ä°zmir BakÄ±rÃ§ay Ãœniversitesi", 
            "Ä°zmir Demokrasi Ãœniversitesi", "Ä°zmir Ekonomi Ãœniversitesi", "Ä°zmir Katip Ã‡elebi Ãœniversitesi", 
            "Ä°zmir Kavram Meslek YÃ¼ksekokulu", "Ä°zmir TÄ±naztepe Ãœniversitesi", "Ä°zmir YÃ¼ksek Teknoloji EnstitÃ¼sÃ¼", 
            "Kadir Has Ãœniversitesi", "Kafkas Ãœniversitesi", "KahramanmaraÅŸ Ä°stiklal Ãœniversitesi", 
            "KahramanmaraÅŸ SÃ¼tÃ§Ã¼ Ä°mam Ãœniversitesi", "Kapadokya Ãœniversitesi", "KarabÃ¼k Ãœniversitesi", 
            "Karadeniz Teknik Ãœniversitesi", "KaramanoÄŸlu Mehmetbey Ãœniversitesi", "Karatay Ãœniversitesi", 
            "Kastamonu Ãœniversitesi", "KÄ±rÄ±kkale Ãœniversitesi", "KÄ±rklareli Ãœniversitesi", "KÄ±rÅŸehir Ahi Evran Ãœniversitesi", 
            "Kilis 7 AralÄ±k Ãœniversitesi", "Kocaeli SaÄŸlÄ±k ve Teknoloji Ãœniversitesi", "Kocaeli Ãœniversitesi", 
            "KoÃ§ Ãœniversitesi", "Konya GÄ±da ve TarÄ±m Ãœniversitesi", "Konya Teknik Ãœniversitesi", "KÃ¼tahya DumlupÄ±nar Ãœniversitesi", 
            "KÃ¼tahya SaÄŸlÄ±k Bilimler Ãœniversitesi", "Lokman Hekim Ãœniversitesi", "Malatya Turgut Ã–zal Ãœniversitesi", 
            "Manisa Celal Bayar Ãœniversitesi", "Mardin Artuklu Ãœniversitesi", "Marmara Ãœniversitesi", 
            "MEF Ãœniversitesi", "Mersin Ãœniversitesi", "Mimar Sinan GÃ¼zel Sanatlar Ãœniversitesi", 
            "Mudanya Ãœniversitesi", "MuÄŸla SÄ±tkÄ± KoÃ§man Ãœniversitesi", "Munzur Ãœniversitesi", "MuÅŸ Alparslan Ãœniversitesi", 
            "Necmettin Erbakan Ãœniversitesi", "NevÅŸehir HacÄ± BektaÅŸ Veli Ãœniversitesi", "NiÄŸde Ã–mer Halisdemir Ãœniversitesi", 
            "NiÅŸantaÅŸÄ± Ãœniversitesi", "Nuh Naci Yazgan Ãœniversitesi", "Ondokuz MayÄ±s Ãœniversitesi", "Ordu Ãœniversitesi", 
            "Orta DoÄŸu Teknik Ãœniversitesi", "Osmaniye Korkut Ata Ãœniversitesi", "Ostim Teknik Ãœniversitesi", 
            "Ã–zyeÄŸin Ãœniversitesi", "Pamukkale Ãœniversitesi", "Piri Reis Ãœniversitesi", "Recep Tayyip ErdoÄŸan Ãœniversitesi", 
            "SabancÄ± Ãœniversitesi", "SaÄŸlÄ±k Bilimleri Ãœniversitesi", "Sakarya UygulamalÄ± Bilimler Ãœniversitesi", 
            "Sakarya Ãœniversitesi", "Samsun Ãœniversitesi", "Sanko Ãœniversitesi", "SelÃ§uk Ãœniversitesi", "Siirt Ãœniversitesi", 
            "Sinop Ãœniversitesi", "Sivas Bilim ve Teknoloji Ãœniversitesi", "Sivas Cumhuriyet Ãœniversitesi", 
            "SÃ¼leyman Demirel Ãœniversitesi", "ÅžÄ±rnak Ãœniversitesi", "Tarsus Ãœniversitesi", "TED Ãœniversitesi", 
            "TekirdaÄŸ NamÄ±k Kemal Ãœniversitesi", "TOBB Ekonomi ve Teknoloji Ãœniversitesi", "Tokat GaziosmanpaÅŸa Ãœniversitesi", 
            "Toros Ãœniversitesi", "Trabzon Ãœniversitesi", "Trakya Ãœniversitesi", "TÃ¼rk Hava Kurumu Ãœniversitesi", 
            "TÃ¼rk-Alman Ãœniversitesi", "TÃ¼rkiye UluslararasÄ± Ä°slam, Bilim ve Teknoloji Ãœniversitesi", 
            "TÃ¼rk-Japon Bilim ve Teknoloji Ãœniversitesi", "Ufuk Ãœniversitesi", "UÅŸak Ãœniversitesi", "ÃœskÃ¼dar Ãœniversitesi", 
            "Van YÃ¼zÃ¼ncÃ¼ YÄ±l Ãœniversitesi", "Yalova Ãœniversitesi", "YaÅŸar Ãœniversitesi", "Yeditepe Ãœniversitesi", 
            "YÄ±ldÄ±z Teknik Ãœniversitesi", "YÃ¼ksek Ä°htisas Ãœniversitesi", "Zonguldak BÃ¼lent Ecevit Ãœniversitesi"
        ];

        const departments = [
            "Acil YardÄ±m ve Afet YÃ¶netimi", "Adalet", "AÄŸÄ±z ve DiÅŸ SaÄŸlÄ±ÄŸÄ±", "Aile ve TÃ¼ketici Bilimleri", 
            "AktÃ¼erya Bilimleri", "Alman Dili ve EdebiyatÄ±", "Amerikan KÃ¼ltÃ¼rÃ¼ ve EdebiyatÄ±", "AntrenÃ¶rlÃ¼k EÄŸitimi", 
            "Arkeoloji", "Astronomi ve Uzay Bilimleri", "AÅŸÃ§Ä±lÄ±k", "BankacÄ±lÄ±k ve SigortacÄ±lÄ±k", "Beslenme ve Diyetetik", 
            "Bilgisayar MÃ¼hendisliÄŸi", "Bilgisayar ProgramcÄ±lÄ±ÄŸÄ±", "Bilgisayar ve Ã–ÄŸretim Teknolojileri Ã–ÄŸretmenliÄŸi", 
            "Bilgi ve Belge YÃ¶netimi", "Bitki Koruma", "Biyokimya", "Biyoloji", "Biyomedikal MÃ¼hendisliÄŸi", 
            "Biyosistem MÃ¼hendisliÄŸi", "Biyoteknoloji", "CoÄŸrafya", "Ã‡alÄ±ÅŸma Ekonomisi ve EndÃ¼stri Ä°liÅŸkileri", 
            "Ã‡eviri Bilim", "Ã‡evre MÃ¼hendisliÄŸi", "Ã‡ocuk GeliÅŸimi", "Deniz UlaÅŸtÄ±rma Ä°ÅŸletme MÃ¼hendisliÄŸi", 
            "Dergi ve Fuar YayÄ±ncÄ±lÄ±ÄŸÄ±", "DiÅŸ HekimliÄŸi", "Ebelik", "EczacÄ±lÄ±k", "Elektrik MÃ¼hendisliÄŸi", 
            "Elektrik-Elektronik MÃ¼hendisliÄŸi", "Elektronik ve HaberleÅŸme MÃ¼hendisliÄŸi", "EndÃ¼stri MÃ¼hendisliÄŸi", 
            "EndÃ¼striyel TasarÄ±m", "Enerji Sistemleri MÃ¼hendisliÄŸi", "Ergoterapi", "Fen Bilgisi Ã–ÄŸretmenliÄŸi", 
            "Felsefe", "Fizik", "Fizik Tedavi ve Rehabilitasyon", "Gastronomi ve Mutfak SanatlarÄ±", 
            "Gazetecilik", "Gemi Ä°nÅŸaatÄ± ve Gemi Makineleri MÃ¼hendisliÄŸi", "Genetik ve BiyomÃ¼hendislik", 
            "GÄ±da MÃ¼hendisliÄŸi", "GÃ¶rsel Ä°letiÅŸim TasarÄ±mÄ±", "Grafik TasarÄ±m", "Halkla Ä°liÅŸkiler ve TanÄ±tÄ±m", 
            "Harita MÃ¼hendisliÄŸi", "HavacÄ±lÄ±k ve Uzay MÃ¼hendisliÄŸi", "HemÅŸirelik", "Hukuk", "Ä°Ã§ MimarlÄ±k", 
            "Ä°Ã§ MimarlÄ±k ve Ã‡evre TasarÄ±mÄ±", "Ä°ktisat", "Ä°lahiyat", "Ä°letiÅŸim Bilimleri", "Ä°letiÅŸim TasarÄ±mÄ±", 
            "Ä°lk ve Acil YardÄ±m", "Ä°lkÃ¶ÄŸretim Matematik Ã–ÄŸretmenliÄŸi", "Ä°ngiliz Dili ve EdebiyatÄ±", 
            "Ä°ngilizce Ã–ÄŸretmenliÄŸi", "Ä°nÅŸaat MÃ¼hendisliÄŸi", "Ä°statistik", "Ä°ÅŸ SaÄŸlÄ±ÄŸÄ± ve GÃ¼venliÄŸi", 
            "Ä°ÅŸletme", "Jeofizik MÃ¼hendisliÄŸi", "Jeoloji MÃ¼hendisliÄŸi", "Kamu YÃ¶netimi", "Kimya", 
            "Kimya MÃ¼hendisliÄŸi", "Klinik Psikoloji", "Lojistik YÃ¶netimi", "Maden MÃ¼hendisliÄŸi", 
            "Makine MÃ¼hendisliÄŸi", "Maliye", "Malzeme Bilimi ve MÃ¼hendisliÄŸi", "Matematik", 
            "Matematik MÃ¼hendisliÄŸi", "Medya ve Ä°letiÅŸim", "Mekatronik MÃ¼hendisliÄŸi", "Metalurji ve Malzeme MÃ¼hendisliÄŸi", 
            "Meteoroloji MÃ¼hendisliÄŸi", "MimarlÄ±k", "MolekÃ¼ler Biyoloji ve Genetik", "Muhasebe ve Finans YÃ¶netimi", 
            "MÃ¼tercim TercÃ¼manlÄ±k", "Nanoteknoloji MÃ¼hendisliÄŸi", "NÃ¼kleer Enerji MÃ¼hendisliÄŸi", "Odyoloji", 
            "Okul Ã–ncesi Ã–ÄŸretmenliÄŸi", "Optisyenlik", "Orman EndÃ¼stri MÃ¼hendisliÄŸi", "Orman MÃ¼hendisliÄŸi", 
            "Otomotiv MÃ¼hendisliÄŸi", "Ã–zel EÄŸitim Ã–ÄŸretmenliÄŸi", "Pazarlama", "Petrol ve DoÄŸalgaz MÃ¼hendisliÄŸi", 
            "Peyzaj MimarlÄ±ÄŸÄ±", "Pilotaj", "Psikoloji", "Psikolojik DanÄ±ÅŸmanlÄ±k ve Rehberlik", 
            "Radyo, Televizyon ve Sinema", "ReklamcÄ±lÄ±k", "Rehberlik ve Psikolojik DanÄ±ÅŸmanlÄ±k", 
            "Rus Dili ve EdebiyatÄ±", "SaÄŸlÄ±k YÃ¶netimi", "Sanat Tarihi", "SÄ±nÄ±f Ã–ÄŸretmenliÄŸi", 
            "Siyaset Bilimi ve Kamu YÃ¶netimi", "Siyaset Bilimi ve UluslararasÄ± Ä°liÅŸkiler", "Sosyal Hizmet", 
            "Sosyoloji", "Spor YÃ¶neticiliÄŸi", "Su ÃœrÃ¼nleri MÃ¼hendisliÄŸi", "Tarih", "TarÄ±m Ekonomisi", 
            "Tekstil MÃ¼hendisliÄŸi", "TÄ±p", "TÄ±bbi DokÃ¼mantasyon ve Sekreterlik", "TÄ±bbi GÃ¶rÃ¼ntÃ¼leme Teknikleri", 
            "TÄ±bbi Laboratuvar Teknikleri", "Turizm Ä°ÅŸletmeciliÄŸi", "Turizm RehberliÄŸi", "TÃ¼rk Dili ve EdebiyatÄ±", 
            "TÃ¼rkÃ§e Ã–ÄŸretmenliÄŸi", "UÃ§ak MÃ¼hendisliÄŸi", "UluslararasÄ± Ä°liÅŸkiler", "UluslararasÄ± Ticaret ve Lojistik", 
            "Veterinerlik", "YazÄ±lÄ±m MÃ¼hendisliÄŸi", "Yeni Medya", "YÃ¶netim BiliÅŸim Sistemleri", "Ziraat MÃ¼hendisliÄŸi", 
            "Zootekni"
        ];

        // SÄ±ralama
        universities.sort((a, b) => a.localeCompare(b, 'tr'));
        departments.sort((a, b) => a.localeCompare(b, 'tr'));

        // --- DROPDOWN FONKSÄ°YONLARI ---
        function setupSearchDropdown(inputId, listId, dataArray) {
            const input = document.getElementById(inputId);
            const list = document.getElementById(listId);

            input.addEventListener('input', () => {
                const val = input.value.toLocaleLowerCase('tr');
                list.innerHTML = '';
                
                if (!val) {
                    list.classList.remove('show');
                    return;
                }

                const filtered = dataArray.filter(item => item.toLocaleLowerCase('tr').includes(val));

                if (filtered.length > 0) {
                    filtered.forEach(item => {
                        const div = document.createElement('div');
                        div.className = 'dropdown-item';
                        div.textContent = item;
                        div.addEventListener('click', () => {
                            input.value = item;
                            list.classList.remove('show');
                        });
                        list.appendChild(div);
                    });
                    list.classList.add('show');
                } else {
                    list.classList.remove('show');
                }
            });

            document.addEventListener('click', (e) => {
                if (!input.contains(e.target) && !list.contains(e.target)) {
                    list.classList.remove('show');
                }
            });
        }

        setupSearchDropdown('universityInput', 'universityList', universities);
        setupSearchDropdown('categoryInput', 'categoryList', departments);

        // --- ANA MANTIK ---
        const uploadForm = document.getElementById('uploadForm');
        const fileInput = document.getElementById('fileInput');
        const fileMsg = document.querySelector('.file-msg');
        const submitBtn = document.querySelector('.btn-submit');
        const authBtn = document.getElementById('authBtn');
        let currentUser = null;

        // DOSYA SEÃ‡Ä°MÄ°NDE PDF KONTROLÃœ (GÃœVENLÄ°K)
        fileInput.addEventListener('change', () => {
            if(fileInput.files.length > 0) {
                const file = fileInput.files[0];
                
                // GÃœVENLÄ°K: Sadece PDF mi?
                if (file.type !== 'application/pdf') {
                    alert("LÃ¼tfen sadece PDF dosyasÄ± yÃ¼kleyiniz! (.docx, .jpg vb. desteklenmez)");
                    fileInput.value = ""; // SeÃ§imi sÄ±fÄ±rla
                    fileMsg.textContent = "HatalÄ± dosya formatÄ±!";
                    return;
                }
                
                fileMsg.textContent = file.name;
            }
        });

        async function checkUser() {
            const { data: { user } } = await supabase.auth.getUser();
            if (user) {
                currentUser = user;
                authBtn.innerText = "HesabÄ±m";
                authBtn.href = "kredilerim.html"; 
            } else {
                authBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    window.location.href = "Kayit.html";
                });
            }
        }
        checkUser();

        uploadForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            if (!currentUser) {
                alert("LÃ¼tfen Ã¶nce giriÅŸ yapÄ±n.");
                window.location.href = "Kayit.html";
                return;
            }

            const uniValue = document.getElementById('universityInput').value;
            const catValue = document.getElementById('categoryInput').value;
            const file = fileInput.files[0];

            if(!uniValue || !catValue) {
                alert("LÃ¼tfen Ãœniversite ve BÃ¶lÃ¼m seÃ§iniz.");
                return;
            }

            // Son kez PDF kontrolÃ¼
            if (!file || file.type !== 'application/pdf') {
                alert("LÃ¼tfen geÃ§erli bir PDF dosyasÄ± seÃ§in.");
                return;
            }

            // Buton kilitleme
            const originalBtnText = submitBtn.innerHTML;
            submitBtn.innerHTML = 'YÃ¼kleniyor... <i class="fa-solid fa-spinner fa-spin"></i>';
            submitBtn.disabled = true;

            const cleanName = file.name.replace(/[^a-zA-Z0-9.]/g, '');
            const fileName = `${Date.now()}_${cleanName}`;

            try {
                // 1. Dosya YÃ¼kle
                const { error: uploadError } = await supabase.storage
                    .from('notlar')
                    .upload(fileName, file);

                if (uploadError) throw uploadError;

                // 2. URL al
                const { data: { publicUrl } } = supabase.storage
                    .from('notlar')
                    .getPublicUrl(fileName);

                // 3. VeritabanÄ±na Yaz
                const { error: dbError } = await supabase
                    .from('notes')
                    .insert([{
                        lesson_name: document.getElementById('lessonName').value,
                        category: catValue,
                        university: uniValue,
                        price: document.getElementById('price').value,
                        description: document.getElementById('description').value,
                        file_url: publicUrl,
                        author_id: currentUser.id,
                        author_email: currentUser.email,
                        sales_count: 0 // GÃ¶rÃ¼ntÃ¼leme sayÄ±sÄ± baÅŸlangÄ±Ã§ta 0
                    }]);

                if (dbError) throw dbError;

                alert("Tebrikler! Notunuz baÅŸarÄ±yla yayÄ±na alÄ±ndÄ±. ðŸš€");
                window.location.href = "not-al.html";

            } catch (error) {
                console.error("Hata:", error);
                alert("Hata: " + error.message);
            } finally {
                submitBtn.innerHTML = originalBtnText;
                submitBtn.disabled = false;
            }
        });
    </script>
</body>

</html>